PKI：机密性 完整性 非否认性 真实性
#12 双证书体系与密钥托管
1.为什么要有双证书？ 
政府可控，政府监听需要。要求PKI提供一种可控的机密性服务。
机密性的私钥应该托管、备份。数字签名私钥应该是用户自主控制的。为了支持法律法规要求，PKI区分了加密证书和签名证书。
加密证书：密钥KMC生成。
签名证书：密钥由订户自己生成。
Key management center(KMC)----key recovery 负责管理用户用于加解密的密钥。

2.双证书流程。
2.1 KMC与用户直接交流。
2.2 CA申请加密公钥，私钥KMC与用户直接通信。
2.3临时公钥保护。依赖对CA的信任，要求CA/KMC在线通信（？？，为啥）。
2.4 KMC将加密密钥放入USB Key。USB Key使用pin码保护，pin码放在信封中。

3.双证书的实现和使用
Key Usage扩展。True，关键扩展
PKI应用系统管理困难，应用很难开展。

4.双证书体系的讨论。
是一种管理措施。

5.电子签名法
POP：私钥的拥有证明。
PKCS#10格式：用户信息签名发送CA，CA公钥解密验证。恶意替换攻击。
签名密钥：同上。恶意替换攻击。
加密密钥：1.直接：CA用公钥加密随机信息让用户解密。2.间接：CA公钥加密证书。
密钥协商密钥：在线通信。RA用申请中的公钥同用户协商session key
流程1支持所有POP检查方式。流程2.3支持加密间接方式。
13 TLS协议
目前PKI最重要的应用。
1.掌握流程图及各层功能。
 
2.Record层：分块——压缩（实际不使用）——计算MAC（流密码、分组密码、AEAD(同时加密校验)）——加密
Handshake层：Handshake基本过程。
 
变形1：server请求client证书，多了CertificateRequest、Certificate、CertificatevVerify
变形2：server证书不能用来签名。多了ServerKeyExchage
变形3：会话重用。SessionId
14 PKI API（略）
15入侵容忍CA系统
秘密分享：
1.	Access structure（n选f组合数记为l）
2.	Shamir’s Secret Sharing（f项多项式曲线）
方案：门限密码分散私钥到各个服务器。
1.	ITTC   d简单拆分。服务器增加减少，调整密钥麻烦。计算简单
2.	ICNP  利用拉格朗日公式。服务器增加减少，调整密钥方便。计算麻烦
16 证书透明化方案
1.为什么？
